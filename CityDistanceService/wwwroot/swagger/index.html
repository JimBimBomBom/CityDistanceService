<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My API Documentation</title>
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui.css" />
</head>
<body>
    <div id="swagger-ui"></div>
    
    <script>
        function loadScript(src, callback) {
            const script = document.createElement('script');
            script.src = src;
            script.onload = callback;
            script.onerror = function() {
                console.error('Error loading script:', src);
            };
            document.head.appendChild(script);
        }

        loadScript('https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-bundle.js', function() {
            loadScript('https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-standalone-preset.js', function() {
                window.onload = function() {
                    // Fetch the versions from versions.json
                    fetch('./versions.json')
                        .then(response => response.json())
                        .then(data => {
                            // Extract versions from the JSON data
                            const versions = data.versions;

                            // Generate URLs dynamically
                            const urls = versions.map(version => {
                                return { url: `/swagger/${version}/swagger.json`, name: `API ${version}` };
                            });

                            // Initialize Swagger UI with dynamically generated URLs
                            const ui = SwaggerUIBundle({
                                urls: urls,
                                dom_id: '#swagger-ui',
                                deepLinking: true,
                                presets: [
                                    SwaggerUIBundle.presets.apis,
                                    SwaggerUIStandalonePreset
                                ],
                                layout: "StandaloneLayout"
                            });

                            window.ui = ui;
                        })
                        .catch(error => console.error('Error fetching versions:', error));
                };
            });
        });
    </script>
</body>
</html>